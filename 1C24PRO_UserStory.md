# 1C24.PRO — Полный User Story

> Каждый экран, каждый клик, каждый API-вызов
> Версия: 15.02.2026

---

## Действующие лица

- **Клиент** — директор ООО «Рассвет», ИНН 7707083893, телефон +7 (999) 123-45-67
- **Админ** — наш сотрудник, управляет сервером
- **Система** — бэкенд 1C24.PRO

---

## АКТ 1. Лендинг → Регистрация

### Сцена 1.1 — Первый визит

Клиент гуглит «1С в облаке», попадает на **1c24.pro**.

Видит лендинг:
- Hero: «Ваша 1С в облаке. Просто работает.»
- BigNumbers: от 690₽, 10 мин, 67 дней, 28%
- Features, Pricing, Calculator, FAQ
- Большая оранжевая кнопка **[Попробовать бесплатно — 30 дней]**

Клиент скроллит, смотрит тарифы, крутит калькулятор.
Решает попробовать. Жмёт **[Попробовать бесплатно]**.

→ Redirect на `/auth`

---

### Сцена 1.2 — Ввод телефона

```
┌─────────────────────────────────────┐
│                                     │
│  🟠 1C24.PRO                        │
│                                     │
│  Войти или зарегистрироваться       │
│                                     │
│  Телефон                            │
│  [+7 (999) 123-45-67          ]     │
│                                     │
│  [Получить код →]                   │
│                                     │
└─────────────────────────────────────┘
```

Клиент вводит: **+7 (999) 123-45-67**
Жмёт **[Получить код]**

**Что происходит:**
```
Фронт → POST /api/v1/auth/send-code
         {phone: "+79991234567"}

Бэкенд:
  1. Нормализация: +7 (999) 123-45-67 → +79991234567
  2. Валидация: формат корректный ✓
  3. Проверка: SELECT * FROM users WHERE phone = '+79991234567'
     → Не найден → is_new_user = true
  4. Генерация OTP: 847293
  5. Хеширование: SHA-256(847293) → сохранить в Redis
     Ключ: otp:+79991234567
     TTL: 300 сек (5 минут)
  6. SMS.ru API → отправка:
     «1C24.PRO — код подтверждения: 847293. Никому не сообщайте.»

Ответ → {sent: true, is_new_user: true, ttl: 300}
```

---

### Сцена 1.3 — Ввод SMS-кода

```
┌─────────────────────────────────────┐
│                                     │
│  Код отправлен на +7 (999) ***-45-67│
│                                     │
│  [8] [4] [7] [2] [9] [3]           │
│                                     │
│  Не пришёл? Повторно через 54 сек  │
│                                     │
└─────────────────────────────────────┘
```

Клиент получает SMS, вводит **847293**

**Что происходит:**
```
Фронт → POST /api/v1/auth/verify-code
         {phone: "+79991234567", code: "847293"}

Бэкенд:
  1. Достать из Redis: otp:+79991234567
  2. SHA-256("847293") == сохранённый хеш? → ДА ✓
  3. Удалить OTP из Redis
  4. Проверка: пользователь существует? → НЕТ
  5. Создать temp_token (JWT, срок 10 минут, claim: phone_verified)

Ответ → {
  verified: true,
  needs_registration: true,
  temp_token: "eyJ..."
}
```

Фронт видит `needs_registration: true` → показывает форму ИНН

---

### Сцена 1.4 — Ввод ИНН

```
┌─────────────────────────────────────┐
│                                     │
│  Отлично! Осталось указать          │
│  вашу организацию                   │
│                                     │
│  ИНН                                │
│  [7707083893                   ]    │
│                                     │
│  ✅ ООО «Рассвет»                   │
│  Директор: Иванов Пётр Сергеевич   │
│  Адрес: г. Москва, ул. Ленина, 15  │
│  ОКВЭД: 62.01 Разработка ПО       │
│  Статус: Действующая               │
│                                     │
│  [✓] Принимаю условия оферты       │
│                                     │
│  [Создать аккаунт →]               │
│                                     │
└─────────────────────────────────────┘
```

**Шаг за шагом:**

1. Клиент начинает вводить ИНН: `770708...`

2. При вводе 10-й цифры (или 12-й для ИП) — фронт делает запрос:
```
Фронт → POST /api/v1/inn/lookup
         {inn: "7707083893"}

Бэкенд:
  1. Валидация: 10 цифр ✓ (юрлицо) или 12 цифр (ИП)
  2. httpx → POST https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/party
     Headers:
       Authorization: Token e2b6f3a566f82a547655b4f9c755132f81f81b09
       Content-Type: application/json
     Body: {"query": "7707083893"}
  3. DaData возвращает:
     {
       "suggestions": [{
         "value": "ООО \"РАССВЕТ\"",
         "data": {
           "inn": "7707083893",
           "kpp": "770701001",
           "ogrn": "1027700132195",
           "name": {
             "short_with_opf": "ООО \"Рассвет\"",
             "full_with_opf": "ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ \"РАССВЕТ\""
           },
           "type": "LEGAL",
           "management": {"name": "Иванов Пётр Сергеевич", "post": "Генеральный директор"},
           "address": {"unrestricted_value": "г. Москва, ул. Ленина, 15"},
           "okved": "62.01",
           "okved_type": "2014",
           "state": {"status": "ACTIVE"}
         }
       }]
     }

Ответ фронту → {
  inn: "7707083893",
  kpp: "770701001",
  ogrn: "1027700132195",
  name_short: "ООО \"Рассвет\"",
  name_full: "ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ \"РАССВЕТ\"",
  type: "LEGAL",
  director_name: "Иванов Пётр Сергеевич",
  address: "г. Москва, ул. Ленина, 15",
  okved: "62.01",
  okved_name: "Разработка компьютерного программного обеспечения",
  status: "ACTIVE"
}
```

3. Фронт показывает карточку компании (зелёная галочка, всё найдено)

4. Клиент ставит галочку «Принимаю оферту», жмёт **[Создать аккаунт]**

```
Фронт → POST /api/v1/auth/complete-registration
         Headers: Authorization: Bearer <temp_token>
         Body: {inn: "7707083893", referral_code: null}

Бэкенд:
  1. Проверка temp_token: валидный, phone = +79991234567 ✓
  2. Проверка: Organization с ИНН 7707083893 существует? → НЕТ
  3. Создание Organization:
     {
       id: "org_uuid_abc",
       inn: "7707083893",
       kpp: "770701001",
       ogrn: "1027700132195",
       name_short: "ООО \"Рассвет\"",
       name_full: "ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ \"РАССВЕТ\"",
       type: "LEGAL",
       director_name: "Иванов Пётр Сергеевич",
       address: "г. Москва, ул. Ленина, 15",
       okved: "62.01",
       status: "ACTIVE",
       slug: "rassvet"            ← транслитерация: ООО «Рассвет» → rassvet
     }
  4. Создание User:
     {
       id: "user_uuid_123",
       organization_id: "org_uuid_abc",
       phone: "+79991234567",
       phone_verified: true,
       email: null,                ← пока не указан!
       email_verified: false,
       is_owner: true,
       role: "owner",
       referral_code: "X7KM2QBN",  ← случайные 8 символов
       referred_by: null,
       trial_started_at: "2026-02-15T19:30:00Z",
       trial_ends_at: "2026-03-17T19:30:00Z"   ← +30 дней
     }
  5. JWT tokens:
     access_token:  {sub: "user_uuid_123", phone: "+79991234567", role: "owner", exp: +60 мин}
     refresh_token: {sub: "user_uuid_123", exp: +30 дней}
  6. SMS клиенту: «Добро пожаловать в 1C24.PRO! Ваш тестовый период — 30 дней.»
  7. Telegram админу: «Новый клиент: ООО Рассвет, ИНН 7707083893, +7***67»

Ответ → {
  user_id: "user_uuid_123",
  access_token: "eyJ...",
  refresh_token: "eyJ...",
  organization: {name_short: "ООО \"Рассвет\"", slug: "rassvet"}
}
```

5. Фронт сохраняет tokens в localStorage → redirect на `/dashboard`

---

## АКТ 2. Личный кабинет

### Сцена 2.1 — Первый вход в ЛК

```
Фронт → GET /api/v1/me
         Headers: Authorization: Bearer <access_token>

Ответ → {
  user: {
    phone: "+79991234567",
    email: null,
    role: "owner",
    referral_code: "X7KM2QBN"
  },
  organization: {
    name_short: "ООО \"Рассвет\"",
    inn: "7707083893",
    slug: "rassvet"
  },
  trial: {
    active: true,
    started_at: "2026-02-15",
    ends_at: "2026-03-17",
    days_left: 30
  }
}
```

Клиент видит:

```
┌──────────────────────────────────────────────────────┐
│  🟠 1C24.PRO                     [Профиль] [Выйти]  │
│  ООО «Рассвет» | Тест: 30 дней осталось             │
├──────────────────────────────────────────────────────┤
│                                                        │
│  ┌────────────────────────────────────────────────┐   │
│  │ ⚠️  Укажите email, чтобы получать ссылки       │   │
│  │    на готовые базы и документы                  │   │
│  │  [email@___________________]  [Сохранить]      │   │
│  └────────────────────────────────────────────────┘   │
│                                                        │
│  📊 Мои базы                                          │
│  ┌────────────────────────────────────────────────┐   │
│  │  У вас пока нет баз.                           │   │
│  │  Загрузите свою базу 1С или создайте новую!    │   │
│  │                                                 │   │
│  │  [📤 Загрузить базу .dt / .bak]                │   │
│  └────────────────────────────────────────────────┘   │
│                                                        │
│  👤 Профиль                                           │
│  Телефон: +7 (999) 123-45-67  ✅                      │
│  Email: не указан ⚠️                                  │
│  Реферальный код: X7KM2QBN [📋 Копировать]           │
└──────────────────────────────────────────────────────┘
```

---

### Сцена 2.2 — Клиент добавляет email (опционально, но мы настаиваем)

Клиент вводит: **director@rassvet.ru** → жмёт **[Сохранить]**

```
Фронт → PATCH /api/v1/me
         {email: "director@rassvet.ru"}

Бэкенд:
  1. Валидация email: корректный ✓
  2. Уникальность: нет другого юзера с таким email ✓
  3. UPDATE users SET email = 'director@rassvet.ru' WHERE id = ...
  4. Отправить код подтверждения на email:
     «Код подтверждения email: 529174»
  5. email_verified пока = false

Ответ → {email: "director@rassvet.ru", email_verified: false}
```

Клиент вводит код из email → email_verified = true ✅

---

## АКТ 3. Загрузка базы

### Сцена 3.1 — Выбор конфигурации

Клиент жмёт **[📤 Загрузить базу]**

```
┌──────────────────────────────────────────────────────┐
│                                                        │
│  📤 Загрузить базу                                    │
│                                                        │
│  Шаг 1 из 2 — Выберите конфигурацию                  │
│                                                        │
│  ┌──────────────────┐ ┌──────────────────┐            │
│  │ 📗 Бухгалтерия   │ │ 📘 ЗУП 3.1       │            │
│  │    3.0            │ │                  │            │
│  └──────────────────┘ └──────────────────┘            │
│  ┌──────────────────┐ ┌──────────────────┐            │
│  │ 📙 Управление    │ │ 📕 1С:ERP 2.5    │            │
│  │    торговлей 11   │ │                  │            │
│  └──────────────────┘ └──────────────────┘            │
│  ┌──────────────────┐ ┌──────────────────┐            │
│  │ 📓 Комплексная   │ │ 📒 УНФ 3         │            │
│  │    автоматизация │ │                  │            │
│  └──────────────────┘ └──────────────────┘            │
│  ┌──────────────────┐                                 │
│  │ ⚙️  Другая        │                                 │
│  │    конфигурация   │                                 │
│  └──────────────────┘                                 │
│                                                        │
└──────────────────────────────────────────────────────┘
```

Клиент выбирает: **Бухгалтерия 3.0** → `config_code = "bp30"`

---

### Сцена 3.2 — Загрузка файла

```
┌──────────────────────────────────────────────────────┐
│                                                        │
│  📤 Загрузить базу                                    │
│                                                        │
│  Конфигурация: Бухгалтерия 3.0 ✅                     │
│  Имя базы: rassvet_bp30_1 (автоматически)             │
│                                                        │
│  Шаг 2 из 2 — Загрузите файл выгрузки                │
│                                                        │
│  ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┐        │
│  │                                           │        │
│  │    📁 Перетащите файл .dt или .bak сюда   │        │
│  │          или [Выбрать файл]               │        │
│  │                                           │        │
│  │    Максимум: 50 ГБ                        │        │
│  └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘        │
│                                                        │
└──────────────────────────────────────────────────────┘
```

Клиент перетаскивает файл: **buh_rassvet.bak** (2.4 ГБ)

**Что происходит:**

```
=== ШАГ 1: Инициализация ===

Фронт → POST /api/v1/uploads/init
         {
           filename: "buh_rassvet.bak",
           size_bytes: 2576980378,     ← 2.4 ГБ
           config_code: "bp30"
         }

Бэкенд:
  1. Проверка: user авторизован, организация есть ✓
  2. Генерация db_name:
     org.slug = "rassvet"
     config_code = "bp30"
     seq = COUNT(databases WHERE org_id = X AND config_code = "bp30") + 1 = 1
     → db_name = "rassvet_bp30_1"
  3. Проверка уникальности db_name: не занято ✓
  4. Создание Upload:
     {
       id: "upl_uuid_456",
       organization_id: "org_uuid_abc",
       user_id: "user_uuid_123",
       filename: "buh_rassvet.bak",
       size_bytes: 2576980378,
       config_code: "bp30",
       db_name: "rassvet_bp30_1",
       chunk_size: 5242880,            ← 5 МБ
       chunks_expected: 492,           ← ceil(2576980378 / 5242880)
       chunks_received: 0,
       status: "pending",
       storage_path: "/uploads/org_uuid_abc/upl_uuid_456/"
     }
  5. Создание папки: /uploads/org_uuid_abc/upl_uuid_456/

Ответ → {
  upload_id: "upl_uuid_456",
  db_name: "rassvet_bp30_1",
  chunk_size: 5242880,
  chunks_expected: 492
}


=== ШАГ 2: Загрузка chunks (492 запроса) ===

Фронт нарезает файл на части по 5 МБ и отправляет последовательно:

  PUT /api/v1/uploads/upl_uuid_456/chunk/0    → [5 МБ binary]
  PUT /api/v1/uploads/upl_uuid_456/chunk/1    → [5 МБ binary]
  PUT /api/v1/uploads/upl_uuid_456/chunk/2    → [5 МБ binary]
  ...

Бэкенд на каждый chunk:
  1. Сохраняет файл: /uploads/org_uuid_abc/upl_uuid_456/chunk_000
  2. UPDATE uploads SET chunks_received = chunks_received + 1
  3. Ответ: {received: true, chunks_received: N}

Фронт показывает прогресс:
  [████████████████████░░░░░░░░░░] 67% | 1.6 ГБ / 2.4 ГБ | ~3 мин


=== Если соединение оборвалось ===

Фронт → GET /api/v1/uploads/upl_uuid_456/status
Ответ → {chunks_received: 329, chunks_expected: 492, status: "uploading"}
→ Фронт продолжает с chunk 329


=== ШАГ 3: Завершение ===

Фронт → POST /api/v1/uploads/upl_uuid_456/complete

Бэкенд:
  1. Проверка: chunks_received == chunks_expected (492 == 492) ✓
  2. Склеивание: chunk_000 + chunk_001 + ... → buh_rassvet.bak
  3. Проверка размера: 2576980378 == ожидаемый ✓
  4. Удаление chunk-файлов
  5. UPDATE uploads SET status = "uploaded", completed_at = NOW()
  6. Создание Database:
     {
       id: "db_uuid_789",
       organization_id: "org_uuid_abc",
       upload_id: "upl_uuid_456",
       db_name: "rassvet_bp30_1",
       config_code: "bp30",
       name: "Бухгалтерия предприятия 3.0",
       status: "preparing",       ← ждём разворачивания
       web_url: null,
       rdp_url: null
     }
  7. SMS клиенту: «1C24.PRO: ваш файл загружен. Разворачиваем базу, обычно 1-2 часа.»
  8. Email клиенту (если есть): аналогичное сообщение
  9. Telegram админу: «📥 Новая загрузка: ООО Рассвет | Бухгалтерия 3.0 | 2.4 ГБ
     Путь: /uploads/org_uuid_abc/upl_uuid_456/buh_rassvet.bak
     db_name: rassvet_bp30_1»
  10. Email админу: то же + ссылка на админку

Ответ → {status: "uploaded", db_name: "rassvet_bp30_1", message: "Файл загружен"}
```

Клиент видит в ЛК:
```
┌────────────────────────────────────────────┐
│ 📗 Бухгалтерия 3.0        🟡 Разворачиваем │
│ Имя: rassvet_bp30_1                        │
│ Ваш файл загружен (2.4 ГБ).               │
│ Мы разворачиваем базу, обычно 1-2 часа.   │
│ Уведомим вас когда будет готово.           │
└────────────────────────────────────────────┘
```

---

## АКТ 4. Разворачивание (Админ, вручную)

### Сцена 4.1 — Админ получает уведомление

Telegram-бот пишет:
> 📥 Новая загрузка!
> Клиент: ООО «Рассвет» (ИНН 7707083893)
> Конфигурация: Бухгалтерия 3.0
> Файл: buh_rassvet.bak (2.4 ГБ)
> db_name: rassvet_bp30_1
> [Открыть в админке →]

---

### Сцена 4.2 — Админ разворачивает базу

Админ заходит в `/admin`, видит:

```
┌──────────────────────────────────────────────────────┐
│  АДМИНКА 1C24.PRO                                     │
│                                                        │
│  📥 Очередь (1 новая)                                 │
│  ┌────────────────────────────────────────────────┐   │
│  │ 🟡 ООО «Рассвет»                               │   │
│  │ Конфа: Бухгалтерия 3.0 | Файл: 2.4 ГБ         │   │
│  │ db_name: rassvet_bp30_1                         │   │
│  │ Путь: /uploads/org_abc/upl_456/buh_rassvet.bak │   │
│  │ Загружен: 15.02.2026 19:45                      │   │
│  │ Контакт: +7***67 | director@rassvet.ru          │   │
│  │                                                  │   │
│  │ Статус: [Загружена ▼]                           │   │
│  │ Web URL:  [____________________________]        │   │
│  │ RDP URL:  [____________________________]        │   │
│  │ Заметки:  [____________________________]        │   │
│  │                                                  │   │
│  │ [💾 Сохранить]  [📨 Сохранить и уведомить]      │   │
│  └────────────────────────────────────────────────┘   │
└──────────────────────────────────────────────────────┘
```

**Админ делает вручную на сервере:**
```
1. Копирует файл на SQL Server:
   scp /uploads/org_abc/upl_456/buh_rassvet.bak admin@172.10.10.38:/restore/

2. RESTORE в SQL Server Management Studio:
   RESTORE DATABASE [rassvet_bp30_1]
   FROM DISK = 'D:\restore\buh_rassvet.bak'
   WITH MOVE 'main' TO 'D:\databases\rassvet_bp30_1.mdf',
        MOVE 'main_log' TO 'D:\databases\rassvet_bp30_1.ldf'

3. Регистрирует базу в кластере 1С (консоль администрирования):
   Имя: rassvet_bp30_1
   Сервер БД: 172.10.10.38
   База данных: rassvet_bp30_1

4. Публикует через Apache (httpd.conf или через 1С Publisher):
   Alias: /rassvet_bp30_1
   Порт: 15009
   → URL: https://1c24.pro:15009/rassvet_bp30_1

5. (Опционально) Настраивает RDP-ярлык
```

**Админ заполняет в админке:**
```
Статус:   [Активна ▼]
Web URL:  [https://1c24.pro:15009/rassvet_bp30_1]
RDP URL:  [https://1c24.pro/rdp/rassvet_bp30_1.rdp]
Заметки:  [Развёрнуто, всё ок]
```

Жмёт **[📨 Сохранить и уведомить]**

---

### Сцена 4.3 — Автоматическое уведомление клиента

```
Бэкенд:
  1. PATCH /admin/databases/db_uuid_789
     {status: "active", web_url: "...", rdp_url: "...", notify: true}

  2. UPDATE databases SET status = "active", web_url = ..., rdp_url = ...

  3. Уведомления (notify = true):

     ЕСЛИ email_verified = true:
       → Email:
         Тема: «Ваша база Бухгалтерия 3.0 готова! — 1C24.PRO»
         Тело:
         «Здравствуйте!
          Ваша база развёрнута и готова к работе.

          📗 Бухгалтерия предприятия 3.0
          🌐 Веб-доступ: https://1c24.pro:15009/rassvet_bp30_1
          🖥 RDP: https://1c24.pro/rdp/rassvet_bp30_1.rdp

          Также доступно в Личном кабинете: https://1c24.pro/dashboard

          Ваш тестовый период: ещё 29 дней.
          —
          1C24.PRO»

     ВСЕГДА:
       → SMS: «1C24.PRO: ваша база Бухгалтерия 3.0 готова!
         Ссылки в ЛК: 1c24.pro/dashboard»

     В ЛК:
       → Карточка базы обновляется: 🟡 → 🟢
       → Появляются ссылки
```

---

## АКТ 5. Работа в 1С

### Сцена 5.1 — Клиент открывает базу

Клиент заходит в ЛК, видит:

```
┌────────────────────────────────────────────────┐
│ 📗 Бухгалтерия 3.0            🟢 Работает      │
│ Имя базы: rassvet_bp30_1                       │
│                                                  │
│ 🌐 Веб-доступ:                                  │
│    https://1c24.pro:15009/rassvet_bp30_1        │
│    [Открыть в браузере →]                       │
│                                                  │
│ 🖥 Удалённый рабочий стол (RDP):                │
│    [Скачать .rdp файл]                          │
│                                                  │
│ 📊 Информация:                                  │
│    Размер: 2.4 ГБ                               │
│    Последний бэкап: сегодня 04:00               │
│    Конфигурация: Бухгалтерия 3.0                │
└────────────────────────────────────────────────┘
```

Клиент жмёт **[Открыть в браузере]** → открывается 1С через веб.
Или скачивает .rdp файл → подключается через удалённый рабочий стол.

**Всё. Клиент работает в своей 1С.**

---

## АКТ 6. Повторный вход (через неделю)

Клиент заходит на 1c24.pro → жмёт **[Войти]** → `/auth`

```
Вводит телефон: +7 (999) 123-45-67
→ POST /auth/send-code → {is_new_user: false}
→ SMS-код
→ POST /auth/verify-code → {needs_registration: false, access_token, refresh_token}
→ Сразу redirect в /dashboard
→ Видит свои базы, ссылки, статус тестового периода
```

Никакого пароля. Никакого email для входа. Только телефон + SMS.

---

## Сводная таблица: какие данные откуда берутся

| Данные | Источник | Когда |
|--------|----------|-------|
| Телефон | Клиент вводит | Регистрация (шаг 1) |
| SMS-код | Система генерирует | Регистрация (шаг 2) |
| ИНН | Клиент вводит | Регистрация (шаг 3) |
| Название компании | DaData API (по ИНН) | Регистрация (шаг 3) |
| Адрес, директор, ОКВЭД | DaData API (по ИНН) | Регистрация (шаг 3) |
| org_slug (rassvet) | Транслитерация из DaData name_short | Создание Organization |
| Email | Клиент вводит в ЛК | После регистрации (опционально) |
| Конфигурация (bp30) | Клиент выбирает из списка | Перед загрузкой файла |
| db_name (rassvet_bp30_1) | Система: slug + config + seq | POST /uploads/init |
| Web URL | Админ вводит вручную | После разворачивания |
| RDP URL | Админ вводит вручную | После разворачивания |
| Реферальный код | Система генерирует (8 символов) | Создание User |

---

## Что если: крайние случаи

| Ситуация | Решение |
|----------|---------|
| ИНН не найден в DaData | Ошибка: «ИНН не найден. Проверьте и попробуйте снова.» |
| Организация ликвидирована | Ошибка: «Организация со статусом LIQUIDATED. Обратитесь в поддержку.» |
| ИНН уже зарегистрирован другим | «Ваша организация уже зарегистрирована. Обратитесь к владельцу аккаунта.» |
| SMS не пришёл | Кнопка «Повторить» через 60 сек. До 5 повторов. |
| Загрузка прервалась | Resume: GET /status → продолжить с последнего chunk |
| Файл не .dt и не .bak | Фронт: валидация расширения до начала upload |
| Файл > 50 ГБ | Фронт: «Файл слишком большой. Макс. 50 ГБ. Обратитесь в поддержку.» |
| Клиент не указал email | Ссылки только в ЛК. SMS: «зайдите в ЛК». Баннер в ЛК: «Укажите email». |
| 2 базы одной конфигурации | seq увеличивается: rassvet_bp30_1, rassvet_bp30_2 |
| Одинаковые slug у разных орг | slug + первые 4 цифры ИНН: rassvet_7707_bp30_1 (fallback) |
